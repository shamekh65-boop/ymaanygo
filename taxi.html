<!doctype html>
<html lang="nl">
<head>
  <link rel="icon" href="favicon.ico">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Taxi Boeken</title>

  <style>
    :root{
      --bg:#f6f6f6;
      --card:#fff;
      --text:#111;
      --muted:rgba(0,0,0,.62);
      --border:rgba(0,0,0,.10);
      --shadow:0 10px 24px rgba(0,0,0,.08);
      --radius:18px;
    }
    *{box-sizing:border-box}
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:var(--bg);margin:0;color:var(--text)}
    a{color:inherit;text-decoration:none}

    /* Top bar */
    .topbar{
      position:sticky;top:0;z-index:50;
      background:var(--card);
      border-bottom:1px solid var(--border);
      padding:10px 12px;
    }
    .topbar-inner{
      max-width:820px;margin:0 auto;
      display:flex;align-items:center;gap:10px;
    }
    .icon-btn{
      width:42px;height:42px;border-radius:14px;
      border:1px solid var(--border);
      background:#fff;cursor:pointer;
      display:grid;place-items:center;
    }
    .icon-btn:active{transform:translateY(1px)}
    .brand-pill{
      flex:1;
      display:flex;align-items:center;justify-content:center;
    }
    .brand-pill span{
      border:1px solid var(--border);
      border-radius:999px;
      padding:6px 14px;
      font-weight:700;
      background:#fff;
      font-size:14px;
    }
    .hamburger{
      width:18px;height:12px;position:relative;
    }
    .hamburger::before,.hamburger::after,.hamburger div{
      content:"";position:absolute;left:0;right:0;height:2px;background:#111;border-radius:2px;
    }
    .hamburger::before{top:0}
    .hamburger div{top:5px}
    .hamburger::after{bottom:0}

    .search-ico{
      width:18px;height:18px;border:2px solid #111;border-radius:50%;position:relative;
    }
    .search-ico::after{
      content:"";position:absolute;width:9px;height:2px;background:#111;
      right:-7px;bottom:-3px;transform:rotate(45deg);border-radius:2px;
    }

    /* Drawer menu */
    .overlay{
      position:fixed;inset:0;background:rgba(0,0,0,.30);
      z-index:60;display:none;
    }
    .drawer{
      position:fixed;top:0;left:0;height:100%;width:320px;max-width:86vw;
      background:#fff;z-index:61;transform:translateX(-110%);
      transition:transform .22s ease;
      box-shadow:var(--shadow);
      padding:16px;
      display:flex;flex-direction:column;gap:12px;
    }
    .drawer.open{transform:translateX(0)}
    .overlay.open{display:block}
    .drawer-head{display:flex;align-items:center;justify-content:space-between}
    .drawer-title{font-weight:800}
    .close-x{
      width:40px;height:40px;border-radius:14px;border:1px solid var(--border);
      background:#fff;cursor:pointer;font-size:18px;line-height:1;
    }
    .menu-item{
      border:1px solid var(--border);
      border-radius:14px;
      padding:12px 12px;
      font-weight:700;
      background:#fff;
    }

    /* Page */
    .wrap{max-width:820px;margin:16px auto;padding:0 12px 28px}
    .card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:18px;
    }
    .logo{
      display:flex;justify-content:center;margin:8px 0 10px;
    }
    .logo img{height:44px;max-width:100%;object-fit:contain}
    h1{margin:0 0 12px;font-size:28px}
    .grid{display:grid;gap:12px}
    .row{display:grid;gap:10px}
    @media(min-width:760px){.row.two{grid-template-columns:1fr 1fr}}
    label{display:block;font-size:13px;font-weight:800;margin:0 0 6px}
    input,select{
      width:100%;
      padding:12px 12px;
      border-radius:14px;
      border:1px solid rgba(0,0,0,.16);
      background:#fff;outline:none;
    }
    input:focus,select:focus{border-color:#111}
    .inline{
      display:flex;align-items:center;gap:10px;
      padding:10px 12px;border:1px solid var(--border);border-radius:14px;
      background:#fff;
    }
    .inline input{width:auto;padding:0;border:0}
    .actions{
      display:flex;gap:10px;align-items:center;flex-wrap:wrap;margin-top:4px
    }
    .btn{
      padding:12px 14px;border-radius:14px;border:0;cursor:pointer;
      background:#111;color:#fff;font-weight:900;
    }
    .btn.secondary{background:#f2f2f2;color:#111;border:1px solid rgba(0,0,0,.12)}
    .price{font-size:18px;font-weight:900}
    .note{font-size:12px;color:var(--muted);margin-top:8px}
    .meta{font-size:13px;color:rgba(0,0,0,.70);margin-top:8px}
    .small{font-size:12px;color:rgba(0,0,0,.65)}

    /* ✅ nieuw: conditionele velden verbergen/tonen */
    .hidden{display:none !important;}
  </style>
</head>

<body>

  <!-- Topbar -->
  <div class="topbar">
    <div class="topbar-inner">
      <button class="icon-btn" type="button" aria-label="Menu" onclick="openMenu()">
        <span class="hamburger"><div></div></span>
      </button>

      <div class="brand-pill"><span>YmaanyGo</span></div>

      <button class="icon-btn" type="button" aria-label="Zoeken" onclick="goSearch()">
        <span class="search-ico"></span>
      </button>
    </div>
  </div>

  <!-- Drawer -->
  <div id="overlay" class="overlay" onclick="closeMenu()"></div>
  <aside id="drawer" class="drawer" aria-hidden="true">
    <div class="drawer-head">
      <div class="drawer-title">Menu</div>
      <button class="close-x" type="button" onclick="closeMenu()">×</button>
    </div>

   <a class="menu-item" href="index.html" onclick="closeMenu()">Home</a>

   <a class="menu-item" href="taxi.html" onclick="closeMenu()">Taxi boeken</a>

    <a class="menu-item" href="#" onclick="closeMenu(); goSearch(); return false;">Zoeken</a>

    <div class="small" style="margin-top:auto;">
      Indicatieve prijs. Definitieve bevestiging via WhatsApp.
    </div>
  </aside>

  <!-- Page -->
  <div class="wrap">
    <div id="taxi" class="card">
      <div class="logo">
        <img src="./logo.jpeg" alt="YmaanyGo logo">
      </div>

      <h1>Taxi boeken</h1>

      <form id="taxi-form" class="grid" onsubmit="return false;">

        <div class="row two">
          <div>
            <label for="naam">Naam</label>
            <input type="text" id="naam" placeholder="Volledige naam" required>
          </div>
          <div>
            <label for="telefoon">Telefoonnummer</label>
            <input type="tel" id="telefoon" placeholder="06..." required>
          </div>
        </div>

        <!-- Ophaal -->
        <div class="row two">
          <div>
            <label for="van_adres">Ophaaladres (straat + huisnummer)</label>
            <input type="text" id="van_adres" placeholder="Bijv. Jan in 't Veltstraat 92" required>
          </div>
          <div>
            <label for="van_stad">Stad (ophaal)</label>
            <input type="text" id="van_stad" placeholder="Bijv. Den Helder" required>
          </div>
        </div>

        <!-- Bestemming -->
        <div class="row two">
          <div>
            <label for="naar_adres">Bestemming (straat + huisnummer)</label>
            <input type="text" id="naar_adres" placeholder="Bijv. Amalia van Solmsstraat 181" required>
          </div>
          <div>
            <label for="naar_stad">Stad (bestemming)</label>
            <input type="text" id="naar_stad" placeholder="Bijv. Alkmaar" required>
          </div>
        </div>

        <div class="row two">
          <div>
            <label for="tijd">Ophaalmoment</label>
            <input type="datetime-local" id="tijd" required>
          </div>
          <div>
            <label for="auto">Voertuig</label>
            <select id="auto">
              <option value="Standaard">Standaard</option>
              <option value="Comfort">Comfort</option>
              <option value="Busje">Busje (8 pers.)</option>
            </select>
          </div>
        </div>

        <!-- Aantal reizigers قبل Retour -->
        <div class="row two">
          <div>
            <label for="reizigers">Aantal reizigers</label>
            <select id="reizigers">
              <option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option>
              <option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option>
            </select>
          </div>

          <div>
            <label>&nbsp;</label>
            <div class="inline">
              <input type="checkbox" id="retour" onchange="toggleRetour()">
              <strong>Retour</strong>
            </div>
          </div>
        </div>

        <!-- ✅ nieuw: Retour datum/tijd (alleen zichtbaar bij retour) -->
        <div id="retourBlock" class="row hidden">
          <div>
            <label for="retour_tijd">Retour datum & tijd</label>
            <input type="datetime-local" id="retour_tijd">
          </div>
        </div>

        <div class="row">
          <div class="inline">
            <input type="checkbox" id="luchthaven" onchange="toggleLuchthaven()">
            <strong>Vanuit luchthaven?</strong>
          </div>
        </div>

        <!-- ✅ nieuw: Vluchtnummer (alleen zichtbaar bij luchthaven) -->
        <div id="flightBlock" class="row hidden">
          <div>
            <label for="vluchtnummer">Vluchtnummer</label>
            <input type="text" id="vluchtnummer" placeholder="Bijv. KL1234">
          </div>
        </div>

        <div class="actions">
          <button class="btn" type="button" onclick="berekenPrijs()">Bereken mijn ritprijs</button>
          <button class="btn secondary" type="button" onclick="whatsappBoeking()">WhatsApp boeking</button>
          <span id="prijs" class="price"></span>
        </div>

        <div id="afstand" class="meta"></div>

        <div class="note">
          Indicatieve prijs. Definitieve bevestiging via WhatsApp.
        </div>

      </form>
    </div>
  </div>

  <script>
    // ====== MENU ======
    function openMenu(){
      document.getElementById('overlay').classList.add('open');
      document.getElementById('drawer').classList.add('open');
      document.getElementById('drawer').setAttribute('aria-hidden','false');
    }
    function closeMenu(){
      document.getElementById('overlay').classList.remove('open');
      document.getElementById('drawer').classList.remove('open');
      document.getElementById('drawer').setAttribute('aria-hidden','true');
    }
    function goSearch(){
      closeMenu();
      document.getElementById('taxi').scrollIntoView({behavior:'smooth', block:'start'});
      setTimeout(()=>document.getElementById('van_adres').focus(), 350);
    }

    // ✅ nieuw: toggle retour veld
    function toggleRetour(){
      const on = document.getElementById('retour').checked;
      const block = document.getElementById('retourBlock');
      const field = document.getElementById('retour_tijd');
      if(on){
        block.classList.remove('hidden');
        field.required = true;
      }else{
        block.classList.add('hidden');
        field.required = false;
        field.value = "";
      }
    }

    // ✅ nieuw: toggle luchthaven veld
    function toggleLuchthaven(){
      const on = document.getElementById('luchthaven').checked;
      const block = document.getElementById('flightBlock');
      const field = document.getElementById('vluchtnummer');
      if(on){
        block.classList.remove('hidden');
        field.required = true;
      }else{
        block.classList.add('hidden');
        field.required = false;
        field.value = "";
      }
    }

    // ====== PRIJSMODEL (غيّر الأرقام براحتك) ======
    const START_TARIEF = 5.00;      // بداية
    const PER_KM = 2.00;            // لكل كيلومتر
    const COMFORT_TOESLAG = 7.00;   // زيادة للـ Comfort
    const BUSJE_PER_KM = 2.50;      // ✅ busje per kilometer (i.p.v. €20 vast)
    const EXTRA_REIZIGER = 0.00;    // لكل راكب بعد 4

    function fullPickup(){
      const a = document.getElementById('van_adres').value.trim();
      const c = document.getElementById('van_stad').value.trim();
      return (a && c) ? `${a}, ${c}, Nederland` : "";
    }
    function fullDropoff(){
      const a = document.getElementById('naar_adres').value.trim();
      const c = document.getElementById('naar_stad').value.trim();
      return (a && c) ? `${a}, ${c}, Nederland` : "";
    }

    async function geocode(q){
      const url = "https://nominatim.openstreetmap.org/search?format=json&limit=1&q=" + encodeURIComponent(q);
      const res = await fetch(url, { headers: { "Accept":"application/json" }});
      const data = await res.json();
      if(!data || !data[0]) return null;
      return { lat: parseFloat(data[0].lat), lon: parseFloat(data[0].lon) };
    }

    async function routeDistanceKm(a, b){
      const url = `https://router.project-osrm.org/route/v1/driving/${a.lon},${a.lat};${b.lon},${b.lat}?overview=false`;
      const res = await fetch(url);
      const data = await res.json();
      if(!data || data.code !== "Ok" || !data.routes || !data.routes[0]) return null;
      const meters = data.routes[0].distance;
      const seconds = data.routes[0].duration;
      return { km: meters/1000, minutes: seconds/60 };
    }

    async function berekenPrijs(){
      const van = fullPickup();
      const naar = fullDropoff();

      const voertuig = document.getElementById('auto').value;
      const retour = document.getElementById('retour').checked;
      const reizigers = parseInt(document.getElementById('reizigers').value || "1", 10);

      if(!van || !naar){
        alert("Vul ophaaladres + stad en bestemming + stad in.");
        return;
      }

      // ✅ enforce required fields when toggles are on
      if(retour && !document.getElementById('retour_tijd').value){
        alert("Vul Retour datum & tijd in.");
        return;
      }
      if(document.getElementById('luchthaven').checked && !document.getElementById('vluchtnummer').value.trim()){
        alert("Vul het vluchtnummer in.");
        return;
      }

      document.getElementById('prijs').innerText = "Bezig...";
      document.getElementById('afstand').innerText = "";

      const A = await geocode(van);
      const B = await geocode(naar);

      if(!A || !B){
        alert("Adres niet gevonden. Controleer straat/nummer en stad.");
        document.getElementById('prijs').innerText = "";
        return;
      }

      const r = await routeDistanceKm(A, B);
      if(!r){
        alert("Kon afstand niet berekenen.");
        document.getElementById('prijs').innerText = "";
        return;
      }

      let prijs = START_TARIEF + (r.km * PER_KM);

      if (voertuig === "Comfort") prijs += COMFORT_TOESLAG;

      // ✅ busje per km
      if (voertuig === "Busje") prijs += (r.km * BUSJE_PER_KM);

      if (reizigers > 4) prijs += (reizigers - 4) * EXTRA_REIZIGER;
      if (retour) prijs = prijs * 2;

      document.getElementById('prijs').innerText = "€ " + prijs.toFixed(2);
      document.getElementById('afstand').innerText =
        `Afstand: ${r.km.toFixed(1)} km • Duur: ${Math.round(r.minutes)} min`;
    }

    function whatsappBoeking(){
      const naam = document.getElementById('naam').value.trim();
      const tel = document.getElementById('telefoon').value.trim();
      const tijd = document.getElementById('tijd').value;

      const van = fullPickup();
      const naar = fullDropoff();

      const voertuig = document.getElementById('auto').value;
      const reizigers = document.getElementById('reizigers').value;
      const retour = document.getElementById('retour').checked;
      const luchthaven = document.getElementById('luchthaven').checked;

      const retourTijd = document.getElementById('retour_tijd').value;
      const vluchtnummer = document.getElementById('vluchtnummer').value.trim();

      const prijs = document.getElementById('prijs').innerText || "Nog niet berekend";
      const afstandInfo = document.getElementById('afstand').innerText || "";

      if(!naam || !tel || !tijd || !van || !naar){
        alert("Vul alle verplichte velden in.");
        return;
      }
      if(retour && !retourTijd){
        alert("Vul Retour datum & tijd in.");
        return;
      }
      if(luchthaven && !vluchtnummer){
        alert("Vul het vluchtnummer in.");
        return;
      }

      const bericht =
`Nieuwe taxi boeking:
Naam: ${naam}
Telefoon: ${tel}
Van: ${van}
Naar: ${naar}
Ophaalmoment: ${tijd}
Voertuig: ${voertuig}
Aantal reizigers: ${reizigers}
Retour: ${retour ? "Ja" : "Nee"}
${retour ? "Retour datum & tijd: " + retourTijd : ""}
Luchthaven: ${luchthaven ? "Ja" : "Nee"}
${luchthaven ? "Vluchtnummer: " + vluchtnummer : ""}
${afstandInfo ? afstandInfo : ""}
Prijs: ${prijs}`;

      const whatsappNummer = "31633337184";
      const url = "https://wa.me/" + whatsappNummer + "?text=" + encodeURIComponent(bericht);
      window.open(url, "_blank");
    }
  </script>

</body>
</html>
 
